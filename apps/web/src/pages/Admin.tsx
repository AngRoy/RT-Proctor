import React,{useEffect,useState} from 'react'
export default function Admin(){const [rows,setRows]=useState<any[]>([]);const [min,setMin]=useState(0);const [adminPwd,setAdminPwd]=useState(localStorage.getItem('admin_pwd')||'');useEffect(()=>{if(!adminPwd){const p=prompt('Admin password (default: ADMIN123)')||'';if(p){localStorage.setItem('admin_pwd',p);setAdminPwd(p)}}},[]);useEffect(()=>{fetch('/api/admin/sessions',{headers:{'x-admin':localStorage.getItem('admin_pwd')||''}}).then(r=>r.json()).then(setRows)},[adminPwd]);return <div><h2>Admin</h2><div className='card'><label>Min suspicion: <input type='number' value={min} onChange={e=>setMin(parseInt(e.target.value||'0'))} /></label><table style={{width:'100%',marginTop:12}}><thead><tr><th>Session</th><th>Calibrated</th><th>Flags</th><th>Suspicion</th></tr></thead><tbody>{rows.filter(r=>r.suspicion>=min).map((r:any)=>(<tr key={r.session_id}><td><a href={'/report/'+r.session_id}>{r.session_id}</a></td><td>{r.calibrated?'Yes':'No'}</td><td>{r.flag_count}</td><td>{r.suspicion}</td></tr>))}</tbody></table></div></div>}
